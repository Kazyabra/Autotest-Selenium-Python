# Маркировка тестов
Когда тестов становится много, хорошо иметь способ разделять тесты не только по названиям,
но также по каким-нибудь заданным нами категориям.

## Как промаркировать тест
Для маркировки теста нужно написать декоратор вида *@pytest.mark.mark_name*, где **mark_name** — произвольная строка.
### Пропустить тест
Итак, чтобы пропустить тест, его отмечают в коде как *@pytest.mark.skip*
### Отметить тест как падающий
Добавим маркировку для падающего теста.

    @pytest.mark.xfail 

Теперь результат прогона всех тестов будет успешен, но падающий тест будет помечен в логах как **XFAIL**
Когда баг починят, мы это узнаем, так как теперь тест в логах будет отмечен как 
**XPASS** (“unexpectedly passing” — неожиданно проходит).

К маркировке *xfail* можно добавлять параметр *reason* - сообщение в консоль при выполнении теста: 

    @pytest.mark.xfail(reason="fixing this bug right now")

Чтобы увидеть это сообщение в консоли, при запуске нужно добавлять параметр pytest **-rx**:

    pytest -rx -v test_fixture10a.py

Дополнительно об использовании этих меток можно почитать в документации:

[Skip and xfail: dealing with tests that cannot succeed](https://pytest.org/en/stable/skipping.html). 
## Как запустить тест
Чтобы запустить тест с нужной маркировкой, нужно передать в командной строке параметр **-m** и нужную метку:

	pytest -s -v -m smoke test_fixture8.py

Если всё сделано правильно, то должен запуститься только тест с маркировкой smoke.
При этом вы увидите **warning**, то есть предупреждение:

Это предупреждение появилось потому, что в последних версиях PyTest настоятельно
рекомендуется регистрировать метки явно перед использованием.
Регистрация, например, позволяет избегать опечаток, когда вы можете ошибочно пометить ваш тест
несуществующей меткой, и он будет пропускаться при прогоне тестов.

### Инверсия
Чтобы запустить все тесты, не имеющие заданную маркировку, можно использовать инверсию. Для запуска всех тестов, 
не отмеченных как *smoke*, нужно выполнить команду:

    pytest -s -v -m "not smoke" test_fixture8.py

### Объединение тестов с разными маркировками
Для запуска тестов с разными метками можно использовать логическое ИЛИ. Запустим *smoke* и *regression*-тесты:

    pytest -s -v -m "smoke or regression" test_fixture8.py

## Как регистрировать метки.
Создайте файл *pytest.ini* в корневой директории вашего тестового проекта и добавьте в файл следующие строки:

	[pytest]
	markers =
		smoke: marker for smoke tests
		regression: marker for regression tests
		sanity: marker for sanity tests
		re-test: marker for re-test tests
		
