#Фикстуры

https://habr.com/ru/company/yandex/blog/242795/

https://docs.pytest.org/en/stable/fixture.html

Фикстурами в PyTest'е называют функции, которые выполняются с различным scope-ом
и возвращают какое-то значение либо выполняют какие-то действия.

Пример:

    import time
    import pytest

    @pytest.fixture(scope='class', autouse=True)
    def suite_data():
        print("\n> Suite setup")
        yield
        print("> Suite teardown")

В данном примере *@pytest.fixture* — декоратор, указывающий,
что функция ниже является фикстурой, *scope=’…’* указывает на “очерёдность” выполнения,
а *autouse=True* говорит о том, что фикстура будет применена для каждого сьюта в тестовом фреймворке

Очерёдность выполнения - их четыре: *session*, *module*, *class* и *function*.
Выполняются они в такой же последовательности.

Из фикстуры можно передать значение в сьют с помощью оператора **yield**.
При этом после **yield** можно добавить ещё код, который будет выполнен после кейса.
Таким образом можно сказать, что всё, что идёт до оператора **yield** является *setup*,
а всё, что после — *teardown* (**yield**, к слову, может ничего и не возвращать,
а просто будет разделителем, отделяющим сетап от тирдауна).

Т.е. пример выше универсальный. А вот ниже можно отдельно сделать для начала и конца:

    import pytest

    def setup_module():
        print('\nБлок запускается в начале всего модуля')

    def teardown_module():
        print('\nБлок запускается в конце всего модуля')

    class TestMainPage1:

        @classmethod
        def setup_class(self):
            print("\nБлок запускается в начале всего класса")

        @classmethod
        def teardown_class(self):
            print("\nБлок запускается в конце всего класса")

    class TestMainPage2:

        def setup_method(self):
            print("\nБлок запускается в начале каждого теста..")

        def teardown_method(self):
            print("\nБлок запускается в конце каждого теста..")

Фикстуры включают в себя необязательный параметр под названием *scope*,
который определяет, как часто фикстура получает setup и teardown.
Параметр *scope* для *@pytest.fixture(scope='function', autouse=False)*
может иметь значения функции, класса, модуля или сессии. *Scope* по умолчанию — это функция.

Краткое описание каждого значения *Scope*:

+ **scope='function'** - Выполняется один раз для каждой функции теста.
Часть setup запускается перед каждым тестом с помощью fixture.
Часть teardown запускается после каждого теста с использованием fixture.
Это область используемая по умолчанию, если параметр scope не указан.

+ **scope='class'** - Выполняется один раз для каждого тестового класса,
независимо от количества тестовых методов в классе.

+ **scope='module'** - Выполняется один раз для каждого модуля, независимо от того,
сколько тестовых функций или методов или других фикстур при использовании модуля.

+ **scope='session'** - Выполняется один раз за сеанс. Все методы и функции тестирования,
использующие фикстуру области сеанса, используют один вызов setup и teardown.

Параметр *autouse* по умолчанию - это **False** ,
в этом случае фикстуру необходимо вызвать вручную.
При *autouse=True* фикстура будет вызываться автоматически с периодичностью,
указанной в параметре *scope*. Например:

    import pytest

    @pytest.fixture(scope='module', autouse=True)
    def print_text():
        print('Начало работы фикстуры')
        yield
        print('Завершение работы фикстуры')

Фикстура без вызова запустится в начале модуля,
выведет сообщение о начале своей работы,
передаст выполнение тестам,
по завершению работы всего кода в модуле сообщит, что завершает работу.